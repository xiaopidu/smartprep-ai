# Feature Specification: UI美化重设计与收藏功能

**Feature Branch**: `001-ui-redesign-favorites`  
**Created**: 2025-11-26  
**Status**: Draft  
**Input**: User description: "将现有页面做的美观一些，修改蓝白底色设计，优化左侧和顶部排版，将选项改为一行两个，添加收藏功能"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 题目选项双列布局优化 (Priority: P1)

用户在做题时，需要更高效地浏览和选择答案。当前每个选项占一行导致页面过长、大量留白，用户需要频繁滚动。优化后选项采用一行两个的布局，同时调整字体大小确保可读性。

**Why this priority**: 这是用户最频繁交互的界面，直接影响刷题效率和用户体验。选项布局是核心功能区域，必须优先优化。

**Independent Test**: 打开任意章节的题目，验证选项是否正确显示为两列布局，文字大小是否适中，页面留白是否减少。

**Acceptance Scenarios**:

1. **Given** 用户打开一道单选题，**When** 页面渲染完成，**Then** 4个选项应显示为2行2列的网格布局
2. **Given** 用户打开一道多选题，**When** 页面渲染完成，**Then** 选项应显示为双列布局，支持多选交互
3. **Given** 用户在移动端访问，**When** 屏幕宽度小于768px，**Then** 选项自动回落为单列布局以保证可读性
4. **Given** 选项文字内容较长（超过50个字符），**When** 页面渲染，**Then** 文字自动换行且不超出选项卡片边界

---

### User Story 2 - 收藏功能实现 (Priority: P1)

用户希望能够收藏重要或有难度的题目，便于后续集中复习。需要在每道题上添加收藏按钮，并在左侧导航中与"错题集"放在一起新增"收藏夹"栏目。同时支持用户为每道题添加笔记备注。

**Why this priority**: 收藏功能是用户明确要求的核心功能，与错题集并列为重要的学习辅助工具，对用户学习效率有直接影响。笔记功能进一步增强学习效果。

**Independent Test**: 点击任意题目的收藏按钮，验证收藏状态变化，然后打开收藏夹栏目验证题目是否出现；为题目添加笔记后验证笔记是否保存。

**Acceptance Scenarios**:

1. **Given** 用户查看一道题目，**When** 点击收藏按钮，**Then** 按钮变为已收藏状态（实心图标），题目被添加到收藏夹
2. **Given** 用户已收藏一道题目，**When** 再次点击收藏按钮，**Then** 取消收藏，按钮恢复未收藏状态（空心图标）
3. **Given** 用户有收藏的题目，**When** 点击左侧导航的"收藏夹"（位于错题集下方），**Then** 显示所有已收藏的题目列表
4. **Given** 用户刷新页面或重新打开应用，**When** 进入收藏夹，**Then** 之前收藏的题目仍然存在（本地持久化）
5. **Given** 收藏夹中有题目，**When** 用户查看收藏夹，**Then** 显示收藏题目的总数badge
6. **Given** 用户查看一道题目，**When** 点击笔记按钮并输入内容保存，**Then** 笔记被保存到本地存储，下次查看该题时可看到笔记内容
7. **Given** 用户已为某题添加笔记，**When** 修改笔记内容并保存，**Then** 新内容覆盖旧内容

---

### User Story 3 - 左侧导航排版优化 (Priority: P2)

当前左侧导航每个章节占一行，导致导航过长需要滚动。优化为更紧凑的布局：保持单列排列但减小行高和内边距，确保8个章节在固定高度内可完全显示且不跨行。

**Why this priority**: 导航是用户切换章节的入口，优化后能提升导航效率，但不影响核心刷题功能。

**Independent Test**: 打开应用，验证左侧导航是否在不滚动的情况下能显示所有8个章节，且每个章节项高度均匀紧凑。

**Acceptance Scenarios**:

1. **Given** 用户打开应用，**When** 查看左侧导航，**Then** 所有8个章节都可见，无需滚动，每行一个章节
2. **Given** 用户在桌面端访问，**When** 查看左侧导航，**Then** 导航项高度减小，内边距紧凑，但文字清晰可读
3. **Given** 用户悬停在章节项上，**When** 鼠标移入，**Then** 有明显的悬停反馈效果（背景色变化或边框变化）

---

### User Story 4 - 顶部区域排版优化 (Priority: P2)

当前顶部区域控制按钮和信息排列零散，需要整理为更整齐的布局，提升视觉美观度。

**Why this priority**: 顶部区域是每个页面的视觉入口，整齐的排版能提升整体应用的专业感。

**Independent Test**: 进入任意章节页面，验证顶部区域的按钮和控件是否整齐对齐，间距是否统一。

**Acceptance Scenarios**:

1. **Given** 用户进入章节练习页面，**When** 查看顶部工具栏，**Then** 所有控制按钮水平对齐，间距均匀
2. **Given** 用户进入错题集页面，**When** 查看顶部区域，**Then** 模式切换、筛选按钮等控件分组明确
3. **Given** 页面宽度变化，**When** 用户调整窗口大小，**Then** 顶部控件自适应换行，不发生重叠

---

### User Story 5 - 整体配色方案优化 (Priority: P3)

当前页面采用蓝白底色，视觉单调缺乏美感。需要引入更丰富的配色方案，提升视觉层次感和现代感。

**Why this priority**: 配色是视觉美化的一部分，但不影响功能使用，可以在核心功能完成后再优化。

**Independent Test**: 打开应用各个页面，验证配色是否有变化，是否比纯蓝白更有层次感。

**Acceptance Scenarios**:

1. **Given** 用户打开应用首页，**When** 页面加载完成，**Then** 背景采用渐变或多层次的配色方案
2. **Given** 用户查看章节卡片，**When** 页面渲染，**Then** 不同章节可以有不同的主题色点缀
3. **Given** 用户做题时，**When** 提交正确/错误答案，**Then** 反馈颜色清晰明确（绿色正确/红色错误）

---

### Edge Cases

- 当选项文字过长时，双列布局如何处理换行和对齐？ **→** 文字自动换行，卡片高度自适应，两列对齐
- 当用户收藏大量题目（如100+）时，收藏夹的性能和滚动体验如何？ **→** 采用虚拟滚动技术，超过50条时启用虚拟滚动只渲染可见区域；支持分页加载，每页50条
- 当题目同时被标记为"错题"和"收藏"时，如何在界面上区分显示？ **→** 叠层徽章显示：同时显示两个徽章标签，红色代表错题，粉色代表收藏，放在题目卡片顶部
- 移动端窄屏幕下，双列布局如何优雅降级为单列？ **→** 采用响应式设计，768px以下自动切换为单列

### Clarifications

#### Session 2025-11-26

- Q1: 配色方案方向 → A: 暖色渐变主题（橙色到粉色）
- Q2: 收藏记录属性细节 → A: questionId + favoriteAt + chapter
- Q3: 大量收藏时的性能策略 → A: 虚拟滚动 + 分页加载（超过50条启用）
- Q4: 收藏与错题并存显示 → B: 叠层徽章显示（红色错题 + 粉色收藏）
- Q5: 左侧导航具体布局方案 → 自定义: 单列紧凑（减小行高和内边距，无跨行）

---

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系统必须支持题目选项的双列网格布局显示
- **FR-002**: 系统必须在每道题目上显示收藏按钮，支持收藏/取消收藏操作
- **FR-003**: 系统必须在左侧导航增加"收藏夹"栏目入口，位于"错题集"下方，两者作为"学习中心"分组
- **FR-004**: 系统必须将收藏数据持久化到浏览器localStorage
- **FR-005**: 系统必须在收藏夹栏目显示当前收藏题目数量的badge
- **FR-005.1**: 系统必须支持用户为每道题添加笔记，笔记数据持久化到localStorage的 `sp_notes` 键下
- **FR-005.2**: 笔记编辑区域必须支持展开/收起状态，避免占用过多屏幕空间
- **FR-006**: 左侧章节导航必须保持单列排列，但通过减小行高和内边距实现紧凑化，确保8个章节完全显示且不需滚动
- **FR-007**: 顶部工具栏控件必须水平对齐，分组明确，间距统一
- **FR-008**: 选项布局必须响应式适配，移动端自动回落为单列
- **FR-009**: 整体配色方案必须引入渐变或多层次色彩
- **FR-010**: 收藏状态变化时必须有视觉反馈（图标变化、动画效果）
- **FR-011**: 收藏夹超过50条题目时，系统必须采用虚拟滚动技术确保流畅性能
- **FR-012**: 当题目同时被标记为"错题"和"收藏"时，必须同时显示两个徽章标签（红色错题 + 粉色收藏），放在题目卡片顶部

### Key Entities

- **收藏记录（Favorite）**: 表示用户收藏的题目，包含以下属性：
  - `questionId` (字符串) - 题目唯一标识符，用于关联题目数据
  - `favoriteAt` (时间戳/毫秒) - 收藏时间，便于按时间排序
  - `chapter` (数字) - 所属章节ID，用于快速筛选

- **收藏列表（FavoriteList）**: 用户所有收藏记录的集合，结构为对象形式 `{ [questionId]: Favorite }`，存储在localStorage的 `sp_favorites` 键下，支持快速查询和CRUD操作

- **题目笔记（QuestionNote）**: 表示用户为某道题添加的笔记，包含以下属性：
  - `questionId` (字符串) - 题目唯一标识符
  - `content` (字符串) - 笔记内容，支持多行文本
  - `updatedAt` (时间戳/毫秒) - 最后更新时间

- **笔记列表（NoteList）**: 用户所有笔记记录的集合，结构为对象形式 `{ [questionId]: QuestionNote }`，存储在localStorage的 `sp_notes` 键下

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户在查看4个选项的单选题时，页面滚动需求减少50%以上
- **SC-002**: 用户能够在3秒内完成一道题的收藏操作
- **SC-003**: 左侧导航在不滚动的情况下能展示至少6个章节入口
- **SC-004**: 页面首次加载后，背景不再是纯白色，有明显的视觉层次
- **SC-005**: 所有顶部控件水平对齐误差不超过2px
- **SC-006**: 收藏数据在页面刷新后100%保持不丢失

## Assumptions

- 用户使用现代浏览器（Chrome、Firefox、Safari、Edge最新两个主要版本）
- 用户设备支持localStorage功能
- 选项文字平均长度在20-50个中文字符以内
- 移动端断点设定为768px
- 收藏题目上限暂不设置（依赖浏览器localStorage容量限制）
